---
title:        'U8Glib bitmap converter'
description:  'Bitmap to C/C++ byte array converter'
category:     [ tools ]
---

<script type="text/javascript">
  /**
   * U8Glib bitmap converter
   * Copyright (C) 2016 João Brázio [https://github.com/jbrazio]
   *
   * This program is free software: you can redistribute it and/or modify
   * it under the terms of the GNU General Public License as published by
   * the Free Software Foundation, either version 3 of the License, or
   * (at your option) any later version.
   *
   * This program is distributed in the hope that it will be useful,
   * but WITHOUT ANY WARRANTY; without even the implied warranty of
   * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
   * GNU General Public License for more details.
   *
   * You should have received a copy of the GNU General Public License
   * along with this program.  If not, see <http://www.gnu.org/licenses/>.
   */
  var img = null;
  var ctx = null;

  head.ready(function() {
    var input  = document.getElementById('file-input');
    var canvas = document.getElementById('preview');

    if (canvas.getContext) {
      ctx = canvas.getContext('2d');
      img = new Image();

      input.addEventListener('change', function() {
        var file = input.files[0];
        if (!file) return;

        var reader = new FileReader();

        reader.addEventListener("load", function () {
          img.src = reader.result;

          ctx.canvas.width  = img.width;
          ctx.canvas.height = img.height;
          ctx.drawImage(img, 0, 0);

          var data = ctx.getImageData(0, 0, canvas.width, canvas.height);
          var buffer = data.data;
          var out = [];

          var lf = Math.floor(ctx.canvas.width /8);
          var l = lf;

          var name = img.src.replace( /\\/g, '/' ).replace( /.*\//, '' ).split('.')[0];
          var bytes = Math.ceil(ctx.canvas.width * ctx.canvas.height /8);

          var j = 0;
          for (var i = 0; i < buffer.length; i += 4) {
            var lum = buffer[i] * 0.3 + buffer[i+1] * 0.59 + buffer[i+2] * 0.11;
            var bit = (lum < 127) ? 1 : 0;
            out.push(bit);

            if (++j == ctx.canvas.width) {
              for (var k = j; k < 8; k++) out.push(1);
              j = 0;
            }
          }

          document.getElementById('output').innerHTML
            = '// Width: ' + ctx.canvas.width + ', Height: ' + ctx.canvas.height + '<br />';

          document.getElementById('output').innerHTML
            += 'const unsigned char ' + name + '[' + bytes + '] PROGMEM = {' + '<br />'

          document.getElementById('output').innerHTML
            += '&nbsp;&nbsp';

          for (var i = 0; i < out.length; i +=8) {
            var byte = null;
            for (var k = 0; k < 8; k++) byte += (out[i + k] << (7-k));

            document.getElementById('output').innerHTML += '0x'
              + ('0' + (byte & 0xFF).toString(16)).slice(-2) + ', ';

            if (l == 0) {
              document.getElementById('output').innerHTML
                += '<br/>' + '&nbsp;&nbsp';
              l = lf;
            }
            else l--;

          }

          document.getElementById('output').innerHTML
            += '<br />' + '}';
        }, false);

        reader.readAsDataURL(file);
      }, false);
    }
  });
</script>

<div class="container" role="main">
  <div class="row">
    <div class="col-lg-12">
      <h1>U8Glib bitmap converter</h1>
      <p>This tool allows you to convert a jpg/png image file to a C/C++ code style array.<br />
         This array can then be used by the OSS Arduino library <a href="https://github.com/olikraus/u8glib">U8Glib</a> to draw custom images on screen.</p>
      <div class="container">
        <div class="row">
          <div class="col-lg-1">
            <canvas id="preview" width="128" height="64"></canvas>
          </div>
          <div class="col-lg-11 custom-pt5">
            <input type="file" id="file-input" accept="image/*" />
          </div>
        </div>
      </div>
      <p>Copy the following array into your program.</p>
      <p><code id="output">You must load an image first.</code></p>
    </div>
  </div>
</div>
