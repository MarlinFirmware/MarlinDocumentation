<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>Trinamic drivers | Marlin Firmware</title> <meta property="og:title" content="Trinamic drivers"> <meta name="author" content="teemuatlut"> <meta property="og:locale" content="en_US"> <meta name="description" content="Using Trinamic TMC based stepper drivers."> <meta property="og:description" content="Using Trinamic TMC based stepper drivers."> <link rel="canonical" href="http://marlinfw.org/docs/features/tmc_drivers.html"> <meta property="og:url" content="http://marlinfw.org/docs/features/tmc_drivers.html"> <meta property="og:site_name" content="Marlin Firmware"> <meta property="og:type" content="article"> <meta property="article:published_time" content="2018-05-25T04:27:00+01:00"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@MarlinFirmware"> <meta name="twitter:creator" content="@teemuatlut"> <script type="application/ld+json">
{"@context":"http://schema.org","@type":"BlogPosting","headline":"Trinamic drivers","author":{"@type":"Person","name":"teemuatlut"},"datePublished":"2018-05-25T04:27:00+01:00","dateModified":"2018-05-25T04:27:00+01:00","description":"Using Trinamic TMC based stepper drivers.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://marlinfw.org/assets/images/logo/marlin/small.png"},"name":"teemuatlut"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://marlinfw.org/docs/features/tmc_drivers.html"},"url":"http://marlinfw.org/docs/features/tmc_drivers.html"}</script> <link rel="icon" href="/assets/favicon.ico"> <link rel="stylesheet" href="/assets/stylesheets/main.css"> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--> <script src="/assets/javascript/head.min.js"></script> <script type="text/javascript">
      /**
       * As Github pages do not support https for custom domains
       * this is the current best workaround for #18.
       */
      var domains  = ['marlinfw.org', 'localhost', '127.0.0.1' ];
      var pathname = location.pathname.replace(/^\/MarlinDocumentation/, '')
      if (domains.indexOf(window.location.hostname) == -1)
          window.top.location.href = 'http://marlinfw.org' + pathname;

      /**
       * Another ugly workaround trying to improve UX reported by #35
       */
       if (location.protocol != 'http:')
           location.href = 'http:' + window.location.href.substring(window.location.protocol.length);

      /**
       * Improves overall speed by loading javascript and css resources in parallel
       * with the main page.
       */
      head.load(
          "/assets/stylesheets/font-awesome.min.css",

          "/assets/javascript/jquery-2.2.1.min.js",
          "/assets/javascript/jquery-ui.min.js",
          "/assets/javascript/bootstrap.min.js",
          "/assets/javascript/tocify.min.js",
          "/assets/javascript/custom.js",

          "/assets/javascript/sheetrock.min.js",
          "/assets/javascript/cookieconsent.min.js"
      );

      head.ready(function() {
        window.cookieconsent_options = {
          "message":"We use cookies to ensure you get the best experience on our website",
          "dismiss": "Got it!", "learnMore": "More info", "link":"", "theme": "dark-bottom"
        };
      });
    </script> </head> <body role="document"> <nav class="navbar navbar-default navbar-fixed-top custom-no-margin"> <div class="container"> <div class="navbar-header"> <a href="/" class="navbar-brand"> <img src="/assets/images/logo/marlin/text-25.png" alt="Marlin"> </a> <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> </div> <div class="navbar-collapse collapse" id="navbar-main"> <ul class="nav navbar-nav"> <li><a href="/docs/basics/introduction.html">About Marlin</a></li> <li><a href="/meta/download/">Download</a></li> <li><a href="/docs/configuration/configuration.html">Configure</a></li> <li><a href="/docs/basics/install.html">Install</a></li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-tools">Tools <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/tools/u8glib/converter.html">Bitmap Converter</a></li> <li><a href="/tools/lin_advance/k-factor.html">K-Factor Calibration Pattern</a></li> <li class="divider"> </li> <li><a href="https://github.com/MarlinFirmware/Marlin/issues">Bugtracker</a></li> <li><a href="/docs/basics/reporting_bugs.html">Reporting bugs</a></li> <li class="divider"> </li> <li><a href="https://github.com/MarlinFirmware/Marlin">Source Code Repository</a></li> </ul> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-documentation">Documentation <span class="caret"></span></a> <ul class="dropdown-menu"> <li class="dropdown-submenu configuration"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Configuration</a> <ul class="dropdown-menu"> <li><a href="/meta/configuration/"> All documents </a></li> <li class="divider"> </li> <li><a href="/docs/configuration/configuration.html"> Configuring Marlin 1.1 </a></li> <li><a href="/docs/configuration/laser_spindle.html"> Laser/Spindle Configuration </a></li> <li><a href="/docs/configuration/probes.html"> Probe Configuration </a></li> </ul> </li> <li class="dropdown-submenu development"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development</a> <ul class="dropdown-menu"> <li><a href="/meta/development/"> All documents </a></li> <li class="divider"> </li> <li><a href="/docs/development/boards.html"> Boards </a></li> <li class="divider"> </li> <li><a href="/docs/development/coding_standards.html"> Coding Standards </a></li> <li><a href="/docs/development/getting_started_pull_requests.html"> Contributing Code with Pull Requests </a></li> <li><a href="/docs/development/git_scripts.html"> Marlin Github Scripts </a></li> <li class="divider"> </li> <li><a href="/docs/development/contributing.html"> Contributing to Marlin </a></li> <li><a href="/docs/development/feature_request.html"> Feature requests </a></li> <li class="divider"> </li> <li><a href="/docs/development/fonts.html"> Adding new fonts </a></li> <li><a href="/docs/development/lcd_language.html"> LCD Language System </a></li> </ul> </li> <li class="dropdown-submenu features"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features</a> <ul class="dropdown-menu"> <li><a href="/meta/features/"> All documents </a></li> <li class="divider"> </li> <li><a href="/docs/features/auto_bed_leveling.html"> Automatic Bed Leveling </a></li> <li><a href="/docs/features/unified_bed_leveling.html"> Unified Bed Leveling </a></li> <li class="divider"> </li> <li><a href="/docs/features/fwretract.html"> Firmware Retract </a></li> <li><a href="/docs/features/lin_advance.html"> Linear Advance </a></li> <li><a href="/docs/features/tmc_drivers.html"> Trinamic drivers </a></li> <li class="divider"> </li> <li><a href="/docs/features/lcd_menu.html"> LCD Menu Tree </a></li> </ul> </li> <li class="dropdown-submenu gcode"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">G-code</a> <ul class="dropdown-menu"> <li><a href="/meta/gcode/"> All documents </a></li> <li class="divider"> </li> <li><a href="/docs/gcode/G000-G001.html"> G0-G1: Linear Move </a></li> <li><a href="/docs/gcode/G002-G003.html"> G2-G3: Controlled Arc Move </a></li> <li><a href="/docs/gcode/G004.html"> G4: Dwell </a></li> <li><a href="/docs/gcode/G005.html"> G5: Bézier cubic spline </a></li> <li><a href="/docs/gcode/G010.html"> G10: Retract </a></li> <li><a href="/docs/gcode/G011.html"> G11: Recover </a></li> <li><a href="/docs/gcode/G012.html"> G12: Clean the Nozzle </a></li> <li><a href="/docs/gcode/G020.html"> G20: Inch Units </a></li> <li><a href="/docs/gcode/G021.html"> G21: Millimeter Units </a></li> <li><a href="/docs/gcode/G026.html"> G26: Mesh Validation Pattern </a></li> <li><a href="/docs/gcode/G027.html"> G27: Park the nozzle </a></li> <li><a href="/docs/gcode/G028.html"> G28: Auto Home </a></li> <li><a href="/docs/gcode/G029-mbl.html"> G29: Mesh Bed Leveling </a></li> <li><a href="/docs/gcode/G029-abl.html"> G29: Automatic Bed Leveling </a></li> <li><a href="/docs/gcode/G029-ubl.html"> G29: Unified Bed Leveling </a></li> <li><a href="/docs/gcode/G030.html"> G30: Single Z-Probe </a></li> <li><a href="/docs/gcode/G031.html"> G31: Dock Sled </a></li> <li><a href="/docs/gcode/G032.html"> G32: Undock Sled </a></li> <li><a href="/docs/gcode/G033.html"> G33: Delta Auto Calibration </a></li> <li><a href="/docs/gcode/G038.html"> G38.2-G38.3: Probe target </a></li> <li><a href="/docs/gcode/G090.html"> G90: Absolute Positioning </a></li> <li><a href="/docs/gcode/G091.html"> G91: Relative Positioning </a></li> <li><a href="/docs/gcode/G092.html"> G92: Set Position </a></li> <li><a href="/docs/gcode/M000-M001.html"> M0-M1: Unconditional stop </a></li> <li><a href="/docs/gcode/M003.html"> M3: Spindle CW / Laser On </a></li> <li><a href="/docs/gcode/M004.html"> M4: Spindle CCW / Laser On </a></li> <li><a href="/docs/gcode/M005.html"> M5: Spindle / Laser Off </a></li> <li><a href="/docs/gcode/M017.html"> M17: Enable Steppers </a></li> <li><a href="/docs/gcode/M018.html"> M18-M84: Disable steppers </a></li> <li><a href="/docs/gcode/M020.html"> M20: List SD Card </a></li> <li><a href="/docs/gcode/M021.html"> M21: Init SD card </a></li> <li><a href="/docs/gcode/M022.html"> M22: Release SD card </a></li> <li><a href="/docs/gcode/M023.html"> M23: Select SD file </a></li> <li><a href="/docs/gcode/M024.html"> M24: Start or Resume SD print </a></li> <li><a href="/docs/gcode/M025.html"> M25: Pause SD print </a></li> <li><a href="/docs/gcode/M026.html"> M26: Set SD position </a></li> <li><a href="/docs/gcode/M027.html"> M27: Report SD print status </a></li> <li><a href="/docs/gcode/M028.html"> M28: Start SD write </a></li> <li><a href="/docs/gcode/M029.html"> M29: Stop SD write </a></li> <li><a href="/docs/gcode/M030.html"> M30: Delete SD file </a></li> <li><a href="/docs/gcode/M031.html"> M31: Print time </a></li> <li><a href="/docs/gcode/M032.html"> M32: Select and Start </a></li> <li><a href="/docs/gcode/M033.html"> M33: Get Long Path </a></li> <li><a href="/docs/gcode/M034.html"> M34: SDCard Sorting </a></li> <li><a href="/docs/gcode/M042.html"> M42: Set Pin State </a></li> <li><a href="/docs/gcode/M043.html"> M43: Debug Pins </a></li> <li><a href="/docs/gcode/M043-T.html"> M43 T: Toggle Details (Debug Pins) </a></li> <li><a href="/docs/gcode/M048.html"> M48: Probe Accuracy Test </a></li> <li><a href="/docs/gcode/M073.html"> M73: Set Print Progress </a></li> <li><a href="/docs/gcode/M075.html"> M75: Start Print Job </a></li> <li><a href="/docs/gcode/M076.html"> M76: Pause Print Job </a></li> <li><a href="/docs/gcode/M077.html"> M77: Stop Print Job </a></li> <li><a href="/docs/gcode/M078.html"> M78: Print Job Stats </a></li> <li><a href="/docs/gcode/M080.html"> M80: Power On </a></li> <li><a href="/docs/gcode/M081.html"> M81: Power Off </a></li> <li><a href="/docs/gcode/M082.html"> M82: E Absolute </a></li> <li><a href="/docs/gcode/M083.html"> M83: E Relative </a></li> <li><a href="/docs/gcode/M085.html"> M85: Inactivity Shutdown </a></li> <li><a href="/docs/gcode/M092.html"> M92: Set Axis Steps-per-unit </a></li> <li><a href="/docs/gcode/M100.html"> M100: Free Memory </a></li> <li><a href="/docs/gcode/M104.html"> M104: Set Hotend Temperature </a></li> <li><a href="/docs/gcode/M105.html"> M105: Report Temperatures </a></li> <li><a href="/docs/gcode/M106.html"> M106: Set Fan Speed </a></li> <li><a href="/docs/gcode/M107.html"> M107: Fan Off </a></li> <li><a href="/docs/gcode/M108.html"> M108: Break and Continue </a></li> <li><a href="/docs/gcode/M109.html"> M109: Wait for Hotend Temperature </a></li> <li><a href="/docs/gcode/M110.html"> M110: Set Line Number </a></li> <li><a href="/docs/gcode/M111.html"> M111: Debug Level </a></li> <li><a href="/docs/gcode/M112.html"> M112: Emergency Stop </a></li> <li><a href="/docs/gcode/M113.html"> M113: Host Keepalive </a></li> <li><a href="/docs/gcode/M114.html"> M114: Get Current Position </a></li> <li><a href="/docs/gcode/M115.html"> M115: Firmware Info </a></li> <li><a href="/docs/gcode/M117.html"> M117: Set LCD Message </a></li> <li><a href="/docs/gcode/M118.html"> M118: Serial print </a></li> <li><a href="/docs/gcode/M119.html"> M119: Endstop States </a></li> <li><a href="/docs/gcode/M120.html"> M120: Enable Endstops </a></li> <li><a href="/docs/gcode/M121.html"> M121: Disable Endstops </a></li> <li><a href="/docs/gcode/M122.html"> M122: TMC Debugging </a></li> <li><a href="/docs/gcode/M125.html"> M125: Park Head </a></li> <li><a href="/docs/gcode/M126.html"> M126: Baricuda 1 Open </a></li> <li><a href="/docs/gcode/M127.html"> M127: Baricuda 1 Close </a></li> <li><a href="/docs/gcode/M128.html"> M128: Baricuda 2 Open </a></li> <li><a href="/docs/gcode/M129.html"> M129: Baricuda 2 Close </a></li> <li><a href="/docs/gcode/M140.html"> M140: Set Bed Temperature </a></li> <li><a href="/docs/gcode/M145.html"> M145: Set Material Preset </a></li> <li><a href="/docs/gcode/M149.html"> M149: Set Temperature Units </a></li> <li><a href="/docs/gcode/M150.html"> M150: Set RGB(W) Color </a></li> <li><a href="/docs/gcode/M155.html"> M155: Temperature Auto-Report </a></li> <li><a href="/docs/gcode/M163.html"> M163: Set Mix Factor </a></li> <li><a href="/docs/gcode/M164.html"> M164: Save Mix </a></li> <li><a href="/docs/gcode/M165.html"> M165: Set Mix </a></li> <li><a href="/docs/gcode/M190.html"> M190: Wait for Bed Temperature </a></li> <li><a href="/docs/gcode/M200.html"> M200: Set Filament Diameter </a></li> <li><a href="/docs/gcode/M201.html"> M201: Set Print Max Acceleration </a></li> <li><a href="/docs/gcode/M203.html"> M203: Set Max Feedrate </a></li> <li><a href="/docs/gcode/M204.html"> M204: Set Starting Acceleration </a></li> <li><a href="/docs/gcode/M205.html"> M205: Set Advanced Settings </a></li> <li><a href="/docs/gcode/M206.html"> M206: Set Home Offsets </a></li> <li><a href="/docs/gcode/M207.html"> M207: Set Firmware Retraction </a></li> <li><a href="/docs/gcode/M208.html"> M208: Set Firmware Recovery </a></li> <li><a href="/docs/gcode/M209.html"> M209: Set Auto Retract </a></li> <li><a href="/docs/gcode/M211.html"> M211: Software Endstops </a></li> <li><a href="/docs/gcode/M218.html"> M218: Set Hotend Offset </a></li> <li><a href="/docs/gcode/M220.html"> M220: Set Feedrate Percentage </a></li> <li><a href="/docs/gcode/M221.html"> M221: Set Flow Percentage </a></li> <li><a href="/docs/gcode/M226.html"> M226: Wait for Pin State </a></li> <li><a href="/docs/gcode/M240.html"> M240: Trigger Camera </a></li> <li><a href="/docs/gcode/M250.html"> M250: LCD Contrast </a></li> <li><a href="/docs/gcode/M260.html"> M260: I2C Send </a></li> <li><a href="/docs/gcode/M261.html"> M261: I2C Request </a></li> <li><a href="/docs/gcode/M280.html"> M280: Servo Position </a></li> <li><a href="/docs/gcode/M290.html"> M290: Babystep </a></li> <li><a href="/docs/gcode/M300.html"> M300: Play Tone </a></li> <li><a href="/docs/gcode/M301.html"> M301: Set Hotend PID </a></li> <li><a href="/docs/gcode/M302.html"> M302: Cold Extrude </a></li> <li><a href="/docs/gcode/M303.html"> M303: PID autotune </a></li> <li><a href="/docs/gcode/M304.html"> M304: Set Bed PID </a></li> <li><a href="/docs/gcode/M350.html"> M350: Set micro-stepping </a></li> <li><a href="/docs/gcode/M351.html"> M351: Set Microstep Pins </a></li> <li><a href="/docs/gcode/M355.html"> M355: Case Light Control </a></li> <li><a href="/docs/gcode/M360.html"> M360: SCARA Theta A </a></li> <li><a href="/docs/gcode/M361.html"> M361: SCARA Theta-B </a></li> <li><a href="/docs/gcode/M362.html"> M362: SCARA Psi-A </a></li> <li><a href="/docs/gcode/M363.html"> M363: SCARA Psi-B </a></li> <li><a href="/docs/gcode/M364.html"> M364: SCARA Psi-C </a></li> <li><a href="/docs/gcode/M380.html"> M380: Activate Solenoid </a></li> <li><a href="/docs/gcode/M381.html"> M381: Deactivate Solenoids </a></li> <li><a href="/docs/gcode/M400.html"> M400: Finish Moves </a></li> <li><a href="/docs/gcode/M401.html"> M401: Deploy Probe </a></li> <li><a href="/docs/gcode/M402.html"> M402: Stow Probe </a></li> <li><a href="/docs/gcode/M404.html"> M404: Set Filament Diameter </a></li> <li><a href="/docs/gcode/M405.html"> M405: Filament Width Sensor On </a></li> <li><a href="/docs/gcode/M406.html"> M406: Filament Width Sensor Off </a></li> <li><a href="/docs/gcode/M407.html"> M407: Filament Width </a></li> <li><a href="/docs/gcode/M410.html"> M410: Quickstop </a></li> <li><a href="/docs/gcode/M420.html"> M420: Bed Leveling State </a></li> <li><a href="/docs/gcode/M421.html"> M421: Set Mesh Value </a></li> <li><a href="/docs/gcode/M428.html"> M428: Home Offsets Here </a></li> <li><a href="/docs/gcode/M500.html"> M500: Save Settings </a></li> <li><a href="/docs/gcode/M501.html"> M501: Restore Settings </a></li> <li><a href="/docs/gcode/M502.html"> M502: Factory Reset </a></li> <li><a href="/docs/gcode/M503.html"> M503: Report Settings </a></li> <li><a href="/docs/gcode/M540.html"> M540: Endstops Abort SD </a></li> <li><a href="/docs/gcode/M600.html"> M600: Filament Change </a></li> <li><a href="/docs/gcode/M605.html"> M605: Dual Nozzle Mode </a></li> <li><a href="/docs/gcode/M665.html"> M665: Delta Configuration </a></li> <li><a href="/docs/gcode/M666.html"> M666: Coming Soon </a></li> <li><a href="/docs/gcode/M851.html"> M851: Z Probe Offset </a></li> <li><a href="/docs/gcode/M852.html"> M852: Bed Skew Compensation </a></li> <li><a href="/docs/gcode/M900.html"> M900: Linear Advance Factors </a></li> <li><a href="/docs/gcode/M906.html"> M906: TMC Motor Current </a></li> <li><a href="/docs/gcode/M907.html"> M907: Set Motor Current </a></li> <li><a href="/docs/gcode/M908.html"> M908: Set Trimpot Pins </a></li> <li><a href="/docs/gcode/M909.html"> M909: DAC Print Values </a></li> <li><a href="/docs/gcode/M910.html"> M910: Commit DAC to EEPROM </a></li> <li><a href="/docs/gcode/M911.html"> M911: TMC OT Pre-Warn Condition </a></li> <li><a href="/docs/gcode/M912.html"> M912: Clear TMC OT Pre-Warn </a></li> <li><a href="/docs/gcode/M913.html"> M913: Set Hybrid Threshold Speed </a></li> <li><a href="/docs/gcode/M914.html"> M914: TMC Bump Sensitivity </a></li> <li><a href="/docs/gcode/M915.html"> M915: TMC Z axis calibration </a></li> <li><a href="/docs/gcode/M928.html"> M928: Start SD Logging </a></li> <li><a href="/docs/gcode/M999.html"> M999: STOP Restart </a></li> </ul> </li> <li class="divider"> </li> <li><a href="/meta/needs-review/">Documentation Needing Review</a></li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right visible-lg-block"> <li><a href="https://github.com/MarlinFirmware/MarlinDocumentation/edit/master/_features/tmc_drivers.md" data-proofer-ignore> <i class="fa fa-pencil-square-o" aria-hidden="true"></i> <span>Improve this page</span> </a></li> </ul> </div> </div> </nav> <div class="container" role="main"> <div class="row"> <div class="col-lg-3 col-md-4 visible-lg-block visible-md-block custom-no-padding"> <div class="custom-fixed-sidebar"> <div id="toc"></div> </div> </div> <div class="col-lg-9 col-md-8 custom-bg-white"> <div class="row"> <div class="col-md-12 custom-article"> <p class="text-right pull-right visible-lg-block hidden-print small custom-pt25"> <a href="https://github.com/teemuatlut" data-toggle="tooltip" data-placement="bottom" title="Visit teemuatlut's profile on Github"><img class="avatar avatar-small" src="https://avatars0.githubusercontent.com/teemuatlut?v=3&amp;s=30" alt="teemuatlut" srcset="https://avatars0.githubusercontent.com/teemuatlut?v=3&amp;s=30 1x, https://avatars0.githubusercontent.com/teemuatlut?v=3&amp;s=60 2x, https://avatars0.githubusercontent.com/teemuatlut?v=3&amp;s=90 3x, https://avatars0.githubusercontent.com/teemuatlut?v=3&amp;s=120 4x" width="30" height="30" data-proofer-ignore="true"></a> </p> <h1 class="custom-article-header">Trinamic drivers</h1> <hr> <p>Trinamic stepper drivers allow you to have better control of your stepper motors and achieve extremely quiet motion. You can influence how the driver manages motor current as well as the manner of current delivery. The drivers can act as endstops allowing you simplify wiring. Marlin also supports setting the driver current by using software commands, negating the need for adjusting trimpots.</p> <h2 id="installing-the-library">Installing the library</h2> <p>The TMC stepper drivers require an external library that allows Marlin to communicate with each driver.</p> <h3 id="installing-from-arduino-ide-library-manager">Installing from Arduino IDE library manager</h3> <ul> <li>Open up the Arduino IDE</li> <li>Go to Sketch -&gt; Include Library -&gt; Manage Libraries…</li> <li>Search for <strong>TMC2130Stepper</strong> or <strong>TMC2208Stepper</strong> </li> <li>Click <code class="highlighter-rouge">Install</code> </li> </ul> <h3 id="installing-from-a-zip-file">Installing from a zip file</h3> <ul> <li>TMC2130: Go to the library homepage at <a href="https://github.com/teemuatlut/TMC2130Stepper">https://github.com/teemuatlut/TMC2130Stepper</a> </li> <li>TMC2208: Go to the library homepage at <a href="https://github.com/teemuatlut/TMC2208Stepper">https://github.com/teemuatlut/TMC2208Stepper</a> </li> <li>Click <code class="highlighter-rouge">Clone or download</code> and <code class="highlighter-rouge">Download ZIP</code> </li> <li>In Arduino IDE and go to Sketch -&gt; Include Library -&gt; Add .ZIP Library…</li> <li>Point to the downloaded file and click <code class="highlighter-rouge">Open</code> </li> </ul> <h2 id="wiring">Wiring</h2> <p>Because the TMC drivers require a way for communication and configuring the drivers (outside of standalone mode) they also require additional setup. TMC2130 uses SPI for communication and TMC2208 uses UART (Serial).</p> <h3 id="tmc2130">TMC2130</h3> <table> <thead> <tr> <th style="text-align: right">Motherboard</th> <th style="text-align: left">Driver</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">SCK</td> <td style="text-align: left">SCK</td> </tr> <tr> <td style="text-align: right">MOSI</td> <td style="text-align: left">SDI</td> </tr> <tr> <td style="text-align: right">MISO</td> <td style="text-align: left">SDO</td> </tr> <tr> <td style="text-align: right">CS</td> <td style="text-align: left">CS</td> </tr> </tbody> </table> <h4 id="software-spi">Software SPI</h4> <p>You can use other than the HW SPI pins by enabling <code class="highlighter-rouge">TMC_USE_SW_SPI</code> and defining the required pins:</p> <div class="language-cpp highlighter-rouge"> <pre class="highlight"><code><span class="n">TMC_SW_MOSI</span>
<span class="n">TMC_SW_MISO</span>
<span class="n">TMC_SW_SCK</span>
</code></pre> </div> <h3 id="tmc2208">TMC2208</h3> <p>A 1 kilo-ohm resistor is required between TX and PD_UART</p> <table> <thead> <tr> <th style="text-align: right">Motherboard</th> <th> </th> <th style="text-align: left">Driver</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">RX</td> <td> </td> <td style="text-align: left">PD_UART</td> </tr> <tr> <td style="text-align: right">TX</td> <td>(1kohm)</td> <td style="text-align: left">PD_UART</td> </tr> </tbody> </table> <p>The serial port on master is selected in your <code class="highlighter-rouge">pins</code> file. Alternatively you can use the slower software serial by not selecting any of the hardware serial ports. Typically one port per one driver is needed.</p> <h4 id="software-uart">Software UART</h4> <p>You can use free pins as UART by disabling all of the hardware serial options in your <code class="highlighter-rouge">pins</code> file and by defining the <code class="highlighter-rouge">_SERIAL_TX_PIN</code> and <code class="highlighter-rouge">_SERIAL_RX_PIN</code> pins.</p> <p><strong>Note:</strong> The receive (RX) pins are limited to only interrupt capable pins. Transmit (TX) pins do not have the same limitation.</p> <h2 id="fysetc-drivers">FYSETC drivers</h2> <p>We recommend getting the original Watterott drivers or the revised FYSETC v1.1 drivers to avoid additional headaches.</p> <p>The FYSETC v1.0 drivers come pre-configured in standalone mode. This means that the drivers should work for moving the axis but you will not be able to configure them nor take advantage of the additional features of the drivers. To get the drivers working as intended you will need to modify three solder bridges on the driver PCB.</p> <p><img src="/assets/images/features/FYSETC_tmc2130._SPI.jpg" alt="FYSETC_TMC2130"></p> <p>Some versions of the FYSETC v1.0 drivers come with a solder bridge left of the chip, some come with a bridging resistor. This connection needs to be opened for SPI connection to work. The two smaller bridges need to be configured as shown.</p> <h2 id="features-and-configuration-options">Features and configuration options</h2> <p>There are several technologies specific to Trinamic drivers that are supported by Marlin.</p> <ul> <li> <a href="https://www.trinamic.com/technology/adv-technologies/stealthchop/">stealthChop</a> is a technology that drives the motors using PWM voltage instead of current. The result is nearly inaudible stepping at low velocities. StealthChop has a lower stepping speed limit and if you need to move faster, for example travel moves, you may want to use spreadCycle or configure Hybrid Mode.</li> <li> <a href="https://www.trinamic.com/technology/adv-technologies/spreadcycle/">spreadCycle</a> is an alternative stepping mode. The driver will use four stages to drive the desired current into the stepper motor. SpreadCycle provides greater torque which might be useful if you’re experiencing skipped steps. The downside is slightly higher noise levels.</li> <li> <a href="https://www.trinamic.com/technology/adv-technologies/stallguard/">stallGuard</a> measures the load that is applied to the motor. If the load is sufficiently high, Marlin can react to the event. Such an event can be when we drive an axis to its physical limit and the signal provided by the driver can be detected just like an endstop. That way you can use the driver itself as an axis sensor negating the need to an additional endstop and the wiring needed. StallGuard is only active when the driver is in spreadCycle mode.</li> <li>Hybrid Mode: Marlin can configure the driver to automatically change between stepping modes using a user configured switching velocity. If the velocity is lower than the threshold the stepper is in quiet stealthChop mode. When the axis velocity increases the driver will automatically switch to spreadCycle.</li> </ul> <table> <thead> <tr> <th style="text-align: right">Option</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">R_SENSE</td> <td style="text-align: left">The current sense resistor used in your product.<br>* Watterott SilentStepSticks typically use 0.11ohm values.<br>* Ultimachine Archim2 board has 0.22ohms.<br>* Panucatt TMC2660 BigFoot drivers use 0.1ohms.</td> </tr> <tr> <td style="text-align: right">HOLD_MULTIPLIER</td> <td style="text-align: left">After the stepper hasn’t been moving for a short while, the driver can decrease the current and let the driver cool down. The multiplier is expressed as a decimal value in the range of 0.0 to 1.0.</td> </tr> <tr> <td style="text-align: right">INTERPOLATE</td> <td style="text-align: left">TMC drivers can take lower microstepping inputs, like the typical 16 and interpolate that to 256 microsteps which provides smoother movement.</td> </tr> <tr> <td style="text-align: right">CURRENT</td> <td style="text-align: left">Driver current expressed in milliamps. Higher current values will need active cooling and a heatsink. Low current values may warrant lower acceleration values to prevent skipping steps.</td> </tr> <tr> <td style="text-align: right">MICROSTEPS</td> <td style="text-align: left">Configures the driver to divide a full step into smaller microsteps which provide smoother movement.</td> </tr> <tr> <td style="text-align: right">STEALTHCHOP</td> <td style="text-align: left">Enable PWM driven stepping mode.</td> </tr> <tr> <td style="text-align: right">AUTOMATIC_CURRENT_CONTROL</td> <td style="text-align: left">Marlin will poll the driver twice a second to see if the driver is in an error state. Such an error can be overtemperature pre-warn condition (OTPW) or short to ground or open load. Marlin can react to the temperature warning and automatically reduce the driver current. Short to ground error will disable the driver and Marlin can terminate the print to save time and material.</td> </tr> <tr> <td style="text-align: right">CURRENT_STEP</td> <td style="text-align: left">Reduce current value when Marlin sees OTPW error.</td> </tr> <tr> <td style="text-align: right">REPORT_CURRENT_CHANGE</td> <td style="text-align: left">Report to the user when automatically changing current setting.</td> </tr> <tr> <td style="text-align: right">HYBRID_THRESHOLD</td> <td style="text-align: left">Configure the axis speed when the driver should switch between stealthChop and spreadCycle modes.</td> </tr> <tr> <td style="text-align: right">SENSORLESS_HOMING</td> <td style="text-align: left">Use the TMC drivers that support this feature to act as endstops by using stallGuard to detect a physical limit.</td> </tr> <tr> <td style="text-align: right">HOMING_SENSITIVITY</td> <td style="text-align: left">The Sensorless Homing sensitivity can be tuned to suit the specific machine.<br>A <strong>higher</strong> value will make homing <strong>less</strong> sensitive.<br>A <strong>lower</strong> value will make homing <strong>more</strong> sensitive.</td> </tr> <tr> <td style="text-align: right">TMC_DEBUG</td> <td style="text-align: left">Enable M122 debugging command. This will give you <em>a lot</em> of additional information about the status of your TMC drivers.</td> </tr> <tr> <td style="text-align: right">TMC_ADV</td> <td style="text-align: left">You can use this to add your own configuration settings. The requirement is that the command used must be part of the respective TMC stepper library. Remember to add a backslash after each command!</td> </tr> </tbody> </table> <h2 id="gcodes">GCodes</h2> <table> <thead> <tr> <th style="text-align: right">Command</th> <th style="text-align: center">Configuration<br>required</th> <th style="text-align: left">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: right"><a href="/docs/gcode/M122.html">M122</a></td> <td style="text-align: center"><code class="highlighter-rouge">TMC_DEBUG</code></td> <td style="text-align: left">Get debugging information of your drivers.</td> </tr> <tr> <td style="text-align: right"><a href="/docs/gcode/M906.html">M906</a></td> <td style="text-align: center">none</td> <td style="text-align: left">Set the driver current using axis letters X/Y/Z/E.</td> </tr> <tr> <td style="text-align: right"><a href="/docs/gcode/M911.html">M911</a></td> <td style="text-align: center">none</td> <td style="text-align: left">Report TMC prewarn triggered flags held by the library.</td> </tr> <tr> <td style="text-align: right"><a href="/docs/gcode/M912.html">M912</a></td> <td style="text-align: center">none</td> <td style="text-align: left">Clear TMC prewarn triggered flags.</td> </tr> <tr> <td style="text-align: right"><a href="/docs/gcode/M913.html">M913</a></td> <td style="text-align: center"><code class="highlighter-rouge">HYBRID_THRESHOLD</code></td> <td style="text-align: left">Set HYBRID_THRESHOLD speed.</td> </tr> <tr> <td style="text-align: right"><a href="/docs/gcode/M914.html">M914</a></td> <td style="text-align: center"><code class="highlighter-rouge">SENSORLESS_HOMING</code></td> <td style="text-align: left">Set SENSORLESS_HOMING sensitivity.</td> </tr> <tr> <td style="text-align: right"><a href="/docs/gcode/M915.html">M915</a></td> <td style="text-align: center"><code class="highlighter-rouge">TMC_Z_CALIBRATION</code></td> <td style="text-align: left">Level your X axis by trying to move the Z axis past its physical limit. The movement is done at a reduced motor current to prevent breaking parts and promote skipped steps. Marlin will then rehome Z axis and restore normal current setting.</td> </tr> </tbody> </table> <h2 id="troubleshooting">Troubleshooting</h2> <ul> <li>Test the current <strong>bugfix</strong> branch of Marlin posted on GitHub (in case your issue is already fixed).</li> <li>Use the latest TMC Stepper libraries.</li> <li>Check all wiring and wire crimps.</li> <li>Check <strong>12V</strong> (<strong>24V</strong>) power in the <strong>Vm</strong> pin and <strong>5V</strong> (<strong>3.3V</strong>) in the <strong>Vio</strong> pin.</li> <li>Check that configured pins match your firmware configuration.</li> <li>Enable <code class="highlighter-rouge">TMC_DEBUG</code> and send <code class="highlighter-rouge">M122</code> to see the debugging output. <ul> <li>Reported register values of either <code class="highlighter-rouge">0x00000000</code> or <code class="highlighter-rouge">0xFFFFFFFF</code> are bad responses.</li> </ul> </li> <li>Try the examples provided by the respective library. Please detach any belts beforehand however, as the examples will not respect any endstop signals or physical limits. You may need to change the pin definitions.</li> </ul> <h2 id="external-resources">External resources</h2> <p><a href="https://github.com/teemuatlut/TMC2130Stepper">Arduino library for TMC2130</a></p> <p><a href="https://github.com/teemuatlut/TMC2208Stepper">Arduino library for TMC2208</a></p> <p><a href="https://github.com/watterott/SilentStepStick/blob/master/hardware/SilentStepStick-TMC2130_v11.pdf">SilentStepStick TMC2130 schematic and pinout</a></p> <p><a href="https://github.com/watterott/SilentStepStick/blob/master/hardware/SilentStepStick-TMC2208_v12.pdf">SilentStepStick TMC2208 schematic and pinout</a></p> <p><a href="https://www.trinamic.com">Trinamic.com</a></p> <p><a href="http://learn.watterott.com/silentstepstick/">Watterott documentation</a></p> <p><a href="https://www.trinamic.com/technology/adv-technologies/stallguard/">stallGuard</a></p> <p><a href="https://www.trinamic.com/technology/adv-technologies/stealthchop/">stealthChop</a></p> <p><a href="https://www.trinamic.com/technology/adv-technologies/spreadcycle/">spreadCycle</a></p> <p><a href="https://www.trinamic.com/fileadmin/assets/Products/ICs_Documents/TMC2130_datasheet.pdf">TMC2130 datasheet</a></p> <p><a href="https://www.trinamic.com/fileadmin/assets/Products/ICs_Documents/TMC220x_TMC222x_Datasheet.pdf">TMC2208 datasheet</a></p> <p><a href="https://hackaday.com/2016/09/30/3d-printering-trinamic-tmc2130-stepper-motor-drivers-shifting-the-gears/">TMC2130 Hackaday article by Moritz Walter</a></p> <p><a href="https://www.youtube.com/watch?v=sPvTB3irCxQ">Video guide by Thomas Sanladerer</a></p> <p><a href="https://www.youtube.com/watch?v=GVs2d-TOims">TMC2208 Torque testing by Alex Kenis</a></p> </div> </div> </div> </div> </div> <footer> <div class="container"> <div class="row"> <div class="col-lg-12"> <hr> </div> </div> <div class="row"> <div class="col-lg-8"> <p>Brought to you with <i class="fa fa-heart text-danger" aria-hidden="true"></i> lack of <i class="fa fa-bed" aria-hidden="true"></i> and lots of <i class="fa fa-coffee" aria-hidden="true"></i>. <br> The contents of this website are © 2018 under the terms of the <a href="http://www.gnu.org/licenses/gpl-3.0.txt">GPLv3</a> License.</p> </div> <div class="col-lg-4"> <div class="pull-right"> <a href="#top" data-proofer-ignore> Back to top <i class="fa fa-level-up" aria-hidden="true"></i></a> </div> </div> </div> </div> </footer> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76230130-1', {
          'cookieDomain': 'marlinfw.org',
          'siteSpeedSampleRate': 80
      });

      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script> </body> </html>